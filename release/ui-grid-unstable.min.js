/*! ui-grid - v2.0.7-844b82d - 2014-01-20
* Copyright (c) 2014 ; Licensed MIT */
!function(){"use strict";function a(a,b){this.row=a,this.col=b}var b=angular.module("ui.grid.cellNav",["ui.grid","ui.grid.util"]);b.constant("uiGridCellNavConstants",{direction:{LEFT:0,RIGHT:1,UP:2,DOWN:3}}),b.service("uiGridCellNavService",["$log","uiGridConstants","uiGridCellNavConstants","$q",function(b,c,d,e){var f={getDirection:function(a){return a.keyCode===c.keymap.LEFT||a.keyCode===c.keymap.TAB&&a.shiftKey?d.direction.LEFT:a.keyCode===c.keymap.RIGHT||a.keyCode===c.keymap.TAB?d.direction.RIGHT:a.keyCode===c.keymap.UP||a.keyCode===c.keymap.ENTER&&a.shiftKey?d.direction.UP:a.keyCode===c.keymap.DOWN||a.keyCode===c.keymap.ENTER?d.direction.DOWN:null},getNextRowCol:function(a,b,c,e){switch(a){case d.direction.LEFT:return f.getRowColLeft(b.rows,b.columns,c,e);case d.direction.RIGHT:return f.getRowColRight(b.rows,b.columns,c,e);case d.direction.UP:return f.getRowColUp(b.rows,b.columns,c,e);case d.direction.DOWN:return f.getRowColDown(b.rows,b.columns,c,e)}},getRowColLeft:function(b,c,d,e){var g=f.getNextColIndexLeft(c,e);return g>e.index?0===d.index?new a(d,c[g]):new a(b[d.index-1],c[g]):new a(d,c[g])},getRowColRight:function(b,c,d,e){var g=f.getNextColIndexRight(c,e);return g<e.index?d.index===b.length-1?new a(d,c[g]):new a(b[d.index+1],c[g]):new a(d,c[g])},getNextColIndexLeft:function(a,b){for(var c=0===b.index?a.length-1:b.index-1;c!==b.index&&!a[c].allowCellFocus;)c--,-1===c&&(c=a.length-1);return c},getNextColIndexRight:function(a,b){for(var c=b.index===a.length-1?0:b.index+1;c!==b.index&&!a[c].allowCellFocus;)c++,c>a.length-1&&(c=0);return c},getRowColUp:function(b,c,d,e){var g=e.allowCellFocus?e.index:f.getNextColIndexRight(c,e);return 0===d.index?new a(d,c[g]):new a(b[d.index-1],c[g])},getRowColDown:function(b,c,d,e){var g=e.allowCellFocus?e.index:f.getNextColIndexRight(c,e);return d.index===b.length-1?new a(d,c[g]):new a(b[d.index+1],c[g])},cellNavColumnBuilder:function(a,b){var c=[];return b.allowCellFocus=void 0!==a.allowCellFocus?a.allowCellFocus:!0,e.all(c)}};return f}]),b.directive("uiGridCellnav",["$log","uiGridCellNavService",function(a,b){return{replace:!0,priority:-150,require:"^uiGrid",scope:!1,compile:function(){return{pre:function(a,c,d,e){e.grid.registerColumnBuilder(b.cellNavColumnBuilder)},post:function(){}}}}}]),b.directive("uiGridCell",["uiGridCellNavService","$log",function(a,b){return{priority:-150,restrict:"A",require:"^uiGrid",scope:!1,link:function(c,d){c.col.allowCellFocus&&d.find("div").attr("tabindex",0),d.on("keydown",function(d){var e=a.getDirection(d);if(null===e)return!0;var f=a.getNextRowCol(e,c.grid,c.row,c.col);return b.debug("next row "+f.row.index+" next Col "+f.col.colDef.name),!1})}}}])}(),function(){"use strict";var a=angular.module("ui.grid.body",[]);a.directive("uiGridBody",["$log","$document","$timeout","uiGridConstants","gridUtil",function(a,b,c,d,e){return{replace:!0,templateUrl:"ui-grid/ui-grid-body",require:"?^uiGrid",scope:!1,link:function(f,g,h,i){function j(a){a.preventDefault();var b,c,e,g;e=a.targetTouches[0].pageX,g=a.targetTouches[0].screenY,b=-(e-o),c=-(g-n),r=1>c?-1:1,s=1>b?-1:1,c*=2,b*=2;var h={target:a.target};if(0!==c){var j=(p+c)/(i.grid.getCanvasHeight()-i.grid.getViewportHeight());h.y={percentage:j,pixels:c}}if(0!==b){var k=(q+b)/(i.grid.getCanvasWidth()-i.grid.getViewportWidth());h.x={percentage:k,pixels:b}}f.$broadcast(d.events.GRID_SCROLL,h)}function k(a){function e(){c(function(){var b={target:a.target};if(0!==x){var c=(i.viewport[0].scrollTop+x)/(i.grid.getCanvasHeight()-i.grid.getViewportHeight());b.y={percentage:c,pixels:x}}if(0!==y){var g=(i.viewport[0].scrollLeft+y)/(i.grid.getCanvasWidth()-i.grid.getViewportWidth());b.x={percentage:g,pixels:y}}f.$broadcast(d.events.GRID_SCROLL,b),w-=1,x/=2,y/=2,w>0&&e()},v)}a.preventDefault(),b.unbind("touchmove",j),b.unbind("touchend",k),b.unbind("touchcancel",k);var g=i.viewport[0].scrollTop,h=i.viewport[0].scrollTop,l=Math.abs(g-p),n=Math.abs(h-q),o=new Date-m,t=l/o,u=n/o,v=125,w=4,x=60*r*t,y=60*s*u;e()}if(void 0===i)throw new Error("[ui-grid-body] uiGridCtrl is undefined!");a.debug("ui-grid-body link"),i.canvas=angular.element(g[0].getElementsByClassName("ui-grid-canvas")[0]),i.viewport=angular.element(g[0].getElementsByClassName("ui-grid-viewport")[0]),i.viewportOuterHeight=e.outerElementHeight(i.viewport[0]),i.viewportOuterWidth=e.outerElementWidth(i.viewport[0]),i.viewport[0].scrollTop=0,i.viewport[0].scrollLeft=0,i.prevScrollTop=0,i.prevScrollLeft=0,i.currentTopRow=0,i.currentFirstColumn=0,i.adjustScrollVertical=function(b,c,d){if(i.prevScrollTop!==b||d){b=i.canvas[0].scrollHeight*c;var e=i.grid.minRowsToRender(),f=i.grid.rows.length-e;i.maxRowIndex=f;var g=Math.ceil(Math.min(f,f*c));g>f&&(g=f);var h=[];if(i.grid.rows.length>i.grid.options.virtualizationThreshold){if(i.prevScrollTop<b&&g<i.prevRowScrollIndex+i.grid.options.scrollThreshold&&f>g)return;if(i.prevScrollTop>b&&g>i.prevRowScrollIndex-i.grid.options.scrollThreshold&&f>g)return;var j=Math.max(0,g-i.grid.options.excessRows),k=Math.min(i.grid.rows.length,g+e+i.grid.options.excessRows);h=[j,k],a.debug(h)}else{var l=i.grid.rows.length;h=[0,Math.max(l,e+i.grid.options.excessRows)]}i.prevScrollTop=b,v(h),i.prevRowScrollIndex=g}},i.adjustScrollHorizontal=function(a,b,c){if(i.prevScrollLeft!==a||c){a=i.canvas[0].scrollLeft*b;var d=i.grid.minColumnsToRender(),e=i.grid.columns.length-d;i.maxColIndex=e;var f=Math.ceil(Math.min(e,e*b));f>e&&(f=e);var g=[];if(i.grid.columns.length>i.grid.options.columnVirtualizationThreshold){if(i.prevScrollLeft<a&&f<i.prevColScrollIndex+i.grid.options.scrollThreshold&&e>f)return;if(i.prevScrollTop>a&&f>i.prevColScrollIndex-i.grid.options.scrollThreshold&&e>f)return;var h=Math.max(0,f-i.grid.options.excessColumns),j=Math.min(i.grid.columns.length,f+d+i.grid.options.excessColumns);g=[h,j]}else{var k=i.grid.columns.length;g=[0,Math.max(k,d+i.grid.options.excessColumns)]}i.prevScrollLeft=a,w(g),i.prevColScrollIndex=f}};var l=f.$on(d.events.GRID_SCROLL,function(a,b){if(b.y){var c=i.grid.getCanvasHeight()-i.grid.getViewportHeight(),d=b.y.percentage,e=Math.max(0,d*c);i.adjustScrollVertical(e,d),i.viewport[0].scrollTop=e,i.grid.options.offsetTop=e}if(b.x){var f=i.grid.getCanvasWidth()-i.grid.getViewportWidth(),g=b.x.percentage,h=Math.max(0,g*f);i.adjustScrollHorizontal(h,g),i.viewport[0].scrollLeft=h,i.grid.options.offsetLeft=h}i.fireScrollingEvent()});g.bind("wheel mousewheel DomMouseScroll MozMousePixelScroll",function(a){a.preventDefault();var b=e.normalizeWheelEvent(a),c={target:g};if(0!==b.deltaY){var h=-120*b.deltaY,j=(i.viewport[0].scrollTop+h)/(i.grid.getCanvasHeight()-i.grid.getViewportHeight());0>j&&(j=0),j>1&&(j=1),c.y={percentage:j,pixels:h}}if(0!==b.deltaX){var k=-120*b.deltaX,l=(i.viewport[0].scrollLeft+k)/(i.grid.getCanvasWidth()-i.grid.getViewportWidth());0>l&&(l=0),l>1&&(l=1),c.x={percentage:l,pixels:k}}f.$broadcast(d.events.GRID_SCROLL,c)});var m,n=0,o=0,p=0,q=0,r=1,s=1;e.isTouchEnabled()&&g.bind("touchstart",function(a){a.preventDefault(),m=new Date,n=a.targetTouches[0].screenY,o=a.targetTouches[0].screenX,p=i.viewport[0].scrollTop,q=i.viewport[0].scrollLeft,b.on("touchmove",j),b.on("touchend touchcancel",k)}),g.bind("keydown",function(){}),g.bind("$destroy",function(){l(),g.unbind("keydown"),["touchstart","touchmove","touchend","keydown","wheel","mousewheel","DomMouseScroll","MozMousePixelScroll"].forEach(function(a){g.unbind(a)})});var t=function(a){f.$evalAsync(function(){i.grid.setRenderedRows(a)})},u=function(a){f.$evalAsync(function(){i.grid.setRenderedColumns(a)})},v=function(a){var b=i.grid.rows.slice(a[0],a[1]);i.currentTopRow=a[0],t(b)},w=function(a){var b=i.grid.columns.slice(a[0],a[1]);i.currentFirstColumn=a[0],u(b)};f.rowStyle=function(a){if(0===a&&0!==i.currentTopRow){var b=i.prevScrollIndex/i.maxRowIndex,c=Math.ceil((i.grid.getCanvasHeight()-i.grid.getViewportHeight())%i.grid.options.rowHeight*b),d=1-b,e=i.grid.options.offsetTop-i.grid.options.rowHeight*(i.grid.options.excessRows-d)-c;return{"margin-top":e+"px"}}return null},f.columnStyle=function(a){if(0===a&&0!==i.currentFirstColumn){var b=i.prevColumnScrollIndex/i.maxColumnIndex,c=Math.ceil((i.grid.getCanvasWidth()-i.grid.getViewportWidth())%i.grid.options.rowHeight*b),d=1-b,e=i.grid.options.offsetLeft-i.grid.options.rowHeight*(i.grid.options.excessColumns-d)-c;return{"margin-left":e+"px"}}return null}}}}])}(),function(){"use strict";var a=angular.module("ui.grid.header",["ui.grid"]);a.directive("uiGridHeader",["$log","$templateCache","$compile","uiGridConstants","gridUtil",function(a,b,c,d,e){var f="ui-grid/ui-grid-header";return{restrict:"EA",replace:!0,require:"?^uiGrid",scope:!1,compile:function(){return{pre:function(a,b,d,g){var h=a.grid.options.headerTemplate?a.grid.options.headerTemplate:f;e.getTemplate(h).then(function(d){var e=angular.element(d),f=c(e)(a);if(b.append(f),g){var h=b[0].getElementsByClassName("ui-grid-header-viewport")[0];h&&(g.headerViewport=h)}})},post:function(b,c,e,f){if(void 0===f)throw new Error("[ui-grid-header] uiGridCtrl is undefined!");if(a.debug("ui-grid-header link"),f){f.header=c;var g=c[0].getElementsByClassName("ui-grid-header-viewport")[0];g&&(f.headerViewport=g)}f&&f.grid.registerStyleComputation(function(){var a=f.grid.getCanvasWidth(),c=a,d=f.grid.options.columnDefs.length;f.grid.options.columnDefs.forEach(function(a){"undefined"!=typeof a.width&&void 0!==a.width&&(c-=a.width,d-=1)});var e=c/d,g="",h=0;f.grid.columns.forEach(function(a,c){var d;d="undefined"!=typeof a.colDef.width&&void 0!==a.colDef.width?a.colDef.width:b.grid.useColumnDrawnWidths&&"undefined"!=typeof a.drawnWidth&&void 0!==a.drawnWidth?a.drawnWidth:e,g=g+" .grid"+f.grid.id+" .col"+c+" { width: "+d+"px; }",h+=e}),b.columnStyles=g});var h=b.$on(d.events.GRID_SCROLL,function(a,b){if(b.x){var c=f.grid.getCanvasWidth()-f.grid.getViewportWidth(),d=b.x.percentage,e=Math.max(0,d*c);f.headerViewport.scrollLeft=e}});c.bind("$destroy",function(){h()})}}}}}])}(),function(){"use strict";var a=angular.module("ui.grid.row",[]);a.directive("uiGridRow",["$log",function(){return{replace:!0,templateUrl:"ui-grid/ui-grid-row",require:"?^uiGrid",scope:{row:"=uiGridRow",rowIndex:"="},compile:function(){return{pre:function(){},post:function(a,b,c,d){if(void 0===d)throw new Error("[ui-grid-row] uiGridCtrl is undefined!");a.grid=d.grid}}}}}])}(),function(){var a=angular.module("ui.grid.scrollbar",[]);a.directive("uiGridScrollbar",["$log","$document","uiGridConstants","gridUtil",function(a,b,c,d){return{replace:!0,templateUrl:"ui-grid/ui-grid-scrollbar",require:"?^uiGrid",scope:{type:"@"},link:function(e,f,g,h){function i(){s=!0,f.addClass("ui-grid-scrollbar-visible"),b.on("mouseup",q)}function j(){s=!1,h.grid.isScrolling()||f.removeClass("ui-grid-scrollbar-visible")}function k(){var a=Math.floor(Math.max(35,h.grid.getViewportHeight()/h.grid.getCanvasHeight()*h.grid.getViewportHeight()));h.grid.verticalScrollbarStyles=".grid"+h.grid.id+" .ui-grid-scrollbar-vertical { height: "+a+"px; }"}function l(){var a=35,b=Math.floor(Math.max(a,h.grid.getViewportWidth()/h.grid.getCanvasWidth()*h.grid.getViewportWidth()));b=isNaN(b)?a:b,h.grid.horizontalScrollbarStyles=".grid"+h.grid.id+" .ui-grid-scrollbar-horizontal { width: "+b+"px; }"}function m(){return"vertical"===e.type?d.elementHeight(f,"margin"):"horizontal"===e.type?d.elementWidth(f,"margin"):void 0}function n(){return"vertical"===e.type?h.grid.getViewportHeight()-m():"horizontal"===e.type?h.grid.getViewportWidth()-m():void 0}function o(a){a.preventDefault(),h.grid.setScrolling(!0),f.addClass(r),x=n(),t=a.screenY-v,u=a.screenX-w,b.on("mousemove",p),b.on("mouseup",q)}function p(a){v=a.screenY-t,w=a.screenX-u;var b={target:f};if("vertical"===e.type){0>v&&(v=0),v>x&&(v=x);var d=v/x;b.y={percentage:d,pixels:v}}else if("horizontal"===e.type){0>w&&(w=0),w>x&&(w=x);var g=w/x;b.x={percentage:g,pixels:w}}e.$emit(c.events.GRID_SCROLL,b)}function q(){f.removeClass(r),s||f.removeClass("ui-grid-scrollbar-visible"),h.grid.setScrolling(!1),b.off("mousemove",p),b.off("mouseup",q)}if(void 0===h)throw new Error("[ui-grid-scrollbar] uiGridCtrl is undefined!");a.debug("ui-grid-scrollbar link",e.type),"vertical"===e.type?f.addClass("ui-grid-scrollbar-vertical"):"horizontal"===e.type&&f.addClass("ui-grid-scrollbar-horizontal");var r;g.$observe("scrollingClass",function(a){a&&(r=a)});var s;h.grid.element.on("mouseenter",i),h.grid.element.on("mouseleave",j),"vertical"===e.type?h.grid.registerStyleComputation(k):"horizontal"===e.type&&h.grid.registerStyleComputation(l),e.showScrollbar=function(){return"vertical"===e.type?h.grid.getCanvasHeight()>h.grid.getViewportHeight():"horizontal"===e.type?h.grid.getCanvasWidth()>h.grid.getViewportWidth():void 0};var t=0,u=0,v=0,w=0,x=n();f.on("mousedown",o);var y=e.$on(c.events.GRID_SCROLL,function(a,b){var c;if("vertical"===e.type){if(!b.y)return;c=b.y.percentage}else if("horizontal"===e.type){if(!b.x)return;c=b.x.percentage}0>c&&(c=0),c>1&&(c=1),x=n();var d=c*x;"vertical"===e.type?(v=d,f.css({top:v+"px"})):(w=d,f.css({left:w+"px"}))});f.on("$destroy",function(){y(),b.off("mousemove",p),b.off("mouseup",q),f.unbind("mousedown"),h.grid.element.off("mouseenter",i),h.grid.element.off("mouseleave",j)})}}}])}(),function(){var a=angular.module("ui.grid.style",[]);a.directive("uiGridStyle",["$log","$interpolate",function(a,b){return{link:function(c,d){a.debug("ui-grid-style link");var e=b(d.text(),!0);e&&c.$watch(e,function(a){d.text(a)})}}}])}(),function(){"use strict";var a=angular.module("ui.grid",["ui.grid.header","ui.grid.body","ui.grid.row","ui.grid.style","ui.grid.scrollbar","ui.grid.util"]);a.constant("uiGridConstants",{CUSTOM_FILTERS:/CUSTOM_FILTERS/g,COL_FIELD:/COL_FIELD/g,DISPLAY_CELL_TEMPLATE:/DISPLAY_CELL_TEMPLATE/g,TEMPLATE_REGEXP:/<.+>/,events:{GRID_SCROLL:"uiGridScroll",GRID_SCROLLING:"uiGridScrolling"},keymap:{TAB:9,STRG:17,CTRL:17,CTRLRIGHT:18,CTRLR:18,SHIFT:16,RETURN:13,ENTER:13,BACKSPACE:8,BCKSP:8,ALT:18,ALTR:17,ALTRIGHT:17,SPACE:32,WIN:91,MAC:91,FN:null,UP:38,DOWN:40,LEFT:37,RIGHT:39,ESC:27,DEL:46,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123}}),a.service("gridClassFactory",["gridUtil","$q","$templateCache","uiGridConstants","$log",function(a,b,c,d,e){function f(){this.data=[],this.columnDefs=[],this.headerRowHeight=30,this.rowHeight=30,this.maxVisibleRowCount=200,this.virtualizationThreshold=50,this.columnVirtualizationThreshold=20,this.excessRows=4,this.excessColumns=4,this.scrollThreshold=4,this.rowEquality=function(a,b){return a===b},this.headerTemplate=null}function g(a,b){this.entity=a,this.index=b}function h(b,c){var d=this;if(d.colDef=b,void 0===b.name)throw new Error("colDef.name is required");d.index=c,d.width=b.width,d.minWidth=b.minWidth?b.minWidth:50,d.maxWidth=b.maxWidth?b.maxWidth:9e3,d.field=void 0===b.field?b.name:b.field,d.displayName=void 0===b.displayName?a.readableColumnName(b.name):b.displayName,d.cellClass=b.cellClass,d.cellFilter=b.cellFilter?b.cellFilter:"",d.visible=a.isNullOrUndefined(b.visible)||b.visible,d.headerClass=b.headerClass}var i={createGrid:function(){var b=new j(a.newId());return b.registerColumnBuilder(i.defaultColumnBuilder),b},defaultColumnBuilder:function(e,f){var g=[];return f.headerCellTemplate=e.headerCellTemplate||c.get("ui-grid/uiGridHeaderCell"),f.cellTemplate=e.cellTemplate||c.get("ui-grid/uiGridCell").replace(d.CUSTOM_FILTERS,f.cellFilter?"|"+f.cellFilter:""),e.cellTemplate&&!d.TEMPLATE_REGEXP.test(e.cellTemplate)&&g.push(a.getTemplate(e.cellTemplate).then(function(a){f.cellTemplate=a})),e.headerCellTemplate&&!d.TEMPLATE_REGEXP.test(e.headerCellTemplate)&&g.push(a.getTemplate(e.headerCellTemplate).then(function(a){f.headerCellTemplate=a})),b.all(g)}},j=function(a){this.id=a,this.options=new f,this.headerHeight=this.options.headerRowHeight,this.gridHeight=0,this.gridWidth=0,this.columnBuilders=[],this.rowBuilders=[],this.styleComputations=[],this.rows=[],this.columns=[],this.renderedRows=[],this.renderedColumns=[]};return j.prototype.registerColumnBuilder=function(a){this.columnBuilders.push(a)},j.prototype.getColumn=function(a){var b=this.columns.filter(function(b){return b.colDef.name===a});return b.length>0?b[0]:null},j.prototype.buildColumns=function(){e.debug("buildColumns");var a=this,c=[];return a.options.columnDefs.forEach(function(b,d){a.preprocessColDef(b);var e=a.getColumn(b.name);e||(e=new h(b,d),a.columns.push(e)),a.columnBuilders.forEach(function(d){c.push(d.call(a,b,e,a.options))})}),b.all(c)},j.prototype.preprocessColDef=function(a){if(!a.field&&!a.name)throw new Error("colDef.name or colDef.field property is required");void 0===a.name&&void 0!==a.field&&(a.name=a.field)},j.prototype.modifyRows=function(a){var b=this;if(0===b.rows.length&&a.length>0)return void b.addRows(a);var c=a.filter(function(a){return!b.rows.some(function(c){return b.options.rowEquality(c.entity,a)})});for(e=0;e<c.length;e++)b.addRows([c[e]]);for(var d=b.rows.filter(function(c){return!a.some(function(a){return b.options.rowEquality(a,c.entity)})}),e=0;e<d.length;e++)b.rows.splice(b.rows.indexOf(d[e]),1)},j.prototype.addRows=function(a){for(var b=this,c=0;c<a.length;c++)b.rows.push(b.processRowBuilders(new g(a[c],c)))},j.prototype.processRowBuilders=function(a){var b=this;return b.rowBuilders.forEach(function(c){c.call(b,a)}),a},j.prototype.registerStyleComputation=function(a){this.styleComputations.push(a)},j.prototype.setRenderedRows=function(a){for(var b=0;b<a.length;b++)this.renderedRows.length=a.length,this.renderedRows[b]=a[b]},j.prototype.setRenderedColumns=function(a){this.renderedColumns.length=a.length;for(var b=0;b<a.length;b++)this.renderedColumns[b]=a[b]},j.prototype.buildStyles=function(a){var b=this;b.styleComputations.forEach(function(c){c.call(b,a)})},j.prototype.minRowsToRender=function(){return Math.ceil(this.getViewportHeight()/this.options.rowHeight)},j.prototype.minColumnsToRender=function(){return 20},j.prototype.getViewportHeight=function(){var a=this.gridHeight-this.headerHeight;return a},j.prototype.getViewportWidth=function(){var a=this.gridWidth;return a},j.prototype.getCanvasHeight=function(){return this.options.rowHeight*this.rows.length},j.prototype.getCanvasWidth=function(){return this.canvasWidth},j.prototype.getTotalRowHeight=function(){return this.options.rowHeight*this.rows.length},j.prototype.isScrolling=function(){return this.scrolling?!0:!1},j.prototype.setScrolling=function(a){this.scrolling=a},g.prototype.getQualifiedColField=function(a){return"row.entity."+a.field},i}]),a.controller("uiGridController",["$scope","$element","$attrs","$log","gridUtil","$q","uiGridConstants","$templateCache","gridClassFactory",function(a,b,c,d,e,f,g,h,i){function j(b){d.debug("dataWatch fired");var g=[];b&&(c.uiGridColumns||0!==k.grid.options.columnDefs.length||(k.grid.options.columnDefs=e.getColumnsFromData(b)),g.push(k.grid.buildColumns()),f.all(g).then(function(){if(d.debug("Modifying rows"),k.grid.modifyRows(b),k.viewport){var c=k.viewport[0].scrollTop,e=k.viewport[0].scrollLeft;k.adjustScrollVertical(c,0,!0),k.adjustScrollHorizontal(e,0,!0)}a.$evalAsync(function(){k.refreshCanvas()})}))}d.debug("ui-grid controller");var k=this;k.grid=i.createGrid(),angular.extend(k.grid.options,a.uiGrid),a.grid=k.grid,c.uiGridColumns?c.$observe("uiGridColumns",function(a){k.grid.options.columnDefs=a,k.grid.buildColumns().then(function(){k.columnSizeCalculated=!1,k.refreshCanvas()})}):k.grid.options.columnDefs.length>0;var l;l=angular.isString(a.uiGrid.data)?a.$parent.$watchCollection(a.uiGrid.data,j):a.$parent.$watchCollection(function(){return a.uiGrid.data},j),a.$on("$destroy",l),a.$watch(function(){return k.grid.styleComputations},function(){k.refreshCanvas()}),a.grid.refreshCanvas=k.refreshCanvas=function(){if(k.header&&!k.columnSizeCalculated){var b=0,c=k.header[0].getElementsByClassName("ui-grid-header-cell");if(c.length>0){for(var d=0;d<c.length;d++){var f=c[d],g=angular.element(f).scope().col,h=f.style.width;f.style.width="auto";var i=e.outerElementWidth(f);g.drawnWidth=i,f.style.width=h,b+=i}b>k.grid.getViewportWidth()?(k.grid.canvasWidth=b,k.grid.useColumnDrawnWidths=!0):k.grid.canvasWidth=k.grid.getViewportWidth(),a.$evalAsync(function(){k.grid.buildStyles(a)}),k.columnSizeCalculated=!0}}k.grid.buildStyles(a),k.header&&(k.grid.headerHeight=e.outerElementHeight(k.header))},k.fireScrollingEvent=function(){a.$broadcast(g.events.GRID_SCROLLING)}}]),a.directive("uiGrid",["$log","$compile","$templateCache","gridUtil",function(a,b,c,d){return{templateUrl:"ui-grid/ui-grid",scope:{uiGrid:"="},replace:!0,controller:"uiGridController",compile:function(){return{post:function(b,c,e,f){a.debug("ui-grid postlink"),f.grid.element=c,f.grid.gridWidth=b.gridWidth=d.elementWidth(c),f.grid.canvasWidth=f.grid.gridWidth,f.grid.gridHeight=b.gridHeight=d.elementHeight(c),f.refreshCanvas()}}}}}]),a.directive("uiGridCell",["$compile","uiGridConstants","$log",function(a,b){var c={priority:0,scope:!1,compile:function(){return{pre:function(c,d){var e=c.col.cellTemplate.replace(b.COL_FIELD,c.row.getQualifiedColField(c.col)),f=a(e)(c);d.append(f)},post:function(){}}}};return c}])}(),function(){function a(a){return a.ownerDocument.defaultView.getComputedStyle(a,null)}function b(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0,h=["Top","Right","Bottom","Left"];4>f;f+=2){var i=h[f];if("margin"===c){var j=parseFloat(e[c+i]);isNaN(j)||(g+=j)}if(d){if("content"===c){var k=parseFloat(e["padding"+i]);isNaN(k)||(g-=k)}if("margin"!==c){var l=parseFloat(e["border"+i+"Width"]);isNaN(l)||(g-=l)}}else{var m=parseFloat(e["padding"+i]);if(isNaN(m)||(g+=m),"padding"!==c){var n=parseFloat(e["border"+i+"Width"]);isNaN(n)||(g+=n)}}}return g}function c(c,d,f){var g=!0,h="width"===d?c.offsetWidth:c.offsetHeight,i=a(c),j="border-box"===i.boxSizing;if(0>=h||null==h){if(h=i[d],(0>h||null==h)&&(h=c.style[d]),e.test(h))return h;g=j&&!0,h=parseFloat(h)||0}var k=h+b(c,d,f||(j?"border":"content"),g,i);return k}var d=angular.module("ui.grid.util",[]),e=new RegExp("^("+/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source+")(?!px)[a-z%]+$","i"),f=/^(block|none|table(?!-c[ea]).+)/,g={position:"absolute",visibility:"hidden",display:"block"};d.service("gridUtil",["$window","$document","$http","$templateCache",function(b,d,e,h){var i={readableColumnName:function(a){return"undefined"==typeof a||void 0===a||null===a?a:("string"!=typeof a&&(a=String(a)),a.replace(/_+/g," ").replace(/^[A-Z]+$/,function(a){return angular.lowercase(angular.uppercase(a.charAt(0))+a.slice(1))}).replace(/(\w+)/g,function(a){return angular.uppercase(a.charAt(0))+a.slice(1)}).replace(/(\w+?(?=[A-Z]))/g,"$1 "))},getColumnsFromData:function(a){var b=[];if(!a||"undefined"==typeof a[0]||void 0===a[0])return[];var c=a[0];return angular.forEach(c,function(a,c){b.push({name:c})}),b},newId:function(){var a=(new Date).getTime();return function(){return a+=1}}(),getTemplate:function(a){return e({method:"GET",url:a,cache:h}).then(function(a){return a.data.trim()},function(b){throw"Could not get template "+a+": "+b})},elementWidth:function(){},elementHeight:function(){},swap:function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e},fakeElement:function(a,b,c){var d,e,f=angular.element(a).clone()[0];for(e in b)f.style[e]=b[e];return angular.element(document.body).append(f),d=c.call(f,f),angular.element(f).remove(),d},normalizeWheelEvent:function(a){var b,c,d,e=a||window.event,f=([].slice.call(arguments,1),0),g=0,h=0,i=0,j=0;return e.originalEvent&&(e=e.originalEvent),e.wheelDelta&&(f=e.wheelDelta),e.detail&&(f=-1*e.detail),h=f,void 0!==e.axis&&e.axis===e.HORIZONTAL_AXIS&&(h=0,g=-1*f),e.deltaY&&(h=-1*e.deltaY,f=h),e.deltaX&&(g=e.deltaX,f=-1*g),void 0!==e.wheelDeltaY&&(h=e.wheelDeltaY),void 0!==e.wheelDeltaX&&(g=-1*e.wheelDeltaX),i=Math.abs(f),(!b||b>i)&&(b=i),j=Math.max(Math.abs(h),Math.abs(g)),(!c||c>j)&&(c=j),d=f>0?"floor":"ceil",f=Math[d](f/b),g=Math[d](g/c),h=Math[d](h/c),{delta:f,deltaX:g,deltaY:h}},isTouchEnabled:function(){var a;return("ontouchstart"in b||b.DocumentTouch&&d instanceof DocumentTouch)&&(a=!0),a},isNullOrUndefined:function(a){return void 0===a||null===a?!0:!1}};return["width","height"].forEach(function(b){var d=angular.uppercase(b.charAt(0))+b.substr(1);i["element"+d]=function(d,e){var h=d;if("undefined"!=typeof h.length&&h.length&&(h=d[0]),h){var j=a(h);return 0===h.offsetWidth&&f.test(j.display)?i.fakeElement(h,g,function(a){return c(a,b,e)}):c(h,b,e)}return null},i["outerElement"+d]=function(a,b){return a?i["element"+d].call(this,a,b?"margin":"border"):null}}),i}]),d.filter("px",function(){return function(a){return a.match(/^[\d\.]+$/)?a+"px":a}})}(),function(){"use strict";var a=angular.module("ui.grid.edit",["ui.grid","ui.grid.util"]);a.constant("uiGridEditConstants",{EDITABLE_CELL_TEMPLATE:/EDITABLE_CELL_TEMPLATE/g,EDITABLE_CELL_DIRECTIVE:/editable_cell_directive/g,events:{BEGIN_CELL_EDIT:"uiGridEventBeginCellEdit",END_CELL_EDIT:"uiGridEventEndCellEdit",CANCEL_CELL_EDIT:"uiGridEventCancelCellEdit"}}),a.service("uiGridEditService",["$log","$q","$templateCache",function(a,b,c){var d={editColumnBuilder:function(a,d,e){var f=[];return d.enableCellEdit=void 0!==a.enableCellEdit?a.enableCellEdit:e.enableCellEdit,d.cellEditableCondition=a.cellEditableCondition||e.cellEditableCondition||"true",d.enableCellEdit&&(d.editableCellTemplate=a.editableCellTemplate||c.get("ui-grid/edit/editableCell"),d.editableCellDirective=a.editableCellDirective||"ui-grid-text-editor"),b.all(f)}};return d}]),a.directive("uiGridEdit",["$log","uiGridEditService",function(a,b){return{replace:!0,priority:5e3,require:"^uiGrid",scope:!1,compile:function(){return{pre:function(c,d,e,f){a.debug("uiGridEdit preLink"),f.grid.registerColumnBuilder(b.editColumnBuilder)},post:function(){}}}}}]),a.directive("uiGridCell",["$compile","uiGridConstants","uiGridEditConstants","$log","$parse",function(a,b,c,d,e){return{priority:-100,restrict:"A",scope:!1,link:function(d,f){function g(){f.on("dblclick",function(){i()}),f.on("keydown",function(a){switch(a.keyCode){case b.keymap.F2:a.stopPropagation(),i()}})}function h(){f.off("dblclick","keydown")}function i(){o=e(d.row.getQualifiedColField(d.col)),n=o(d),l=d.col.cellTemplate,l=l.replace(b.COL_FIELD,d.row.getQualifiedColField(d.col)),m=d.col.editableCellTemplate,m=m.replace(c.EDITABLE_CELL_DIRECTIVE,d.col.editableCellDirective);var g;d.$apply(function(){p=!0,h(),g=a(m)(d),f.find("div").replaceWith(g)});var i=d.$on(b.events.GRID_SCROLL,function(){j(),i()}),q=d.$on(c.events.END_CELL_EDIT,function(){j(),q()}),r=d.$on(c.events.CANCEL_CELL_EDIT,function(){k(),r()});d.$broadcast(c.events.BEGIN_CELL_EDIT)}function j(){if(p){var b=a(l)(d);f.find("div").replaceWith(b),d.$apply(),p=!1,g()}}function k(){p&&(o.assign(d,n),j())}if(d.col.colDef.enableCellEdit){var l,m,n,o,p=!1;g()}}}}]),a.directive("uiGridTextEditor",["uiGridConstants","uiGridEditConstants","$log","$templateCache","$compile",function(a,b,c,d,e){return{compile:function(){return{pre:function(){},post:function(c,f){var g=d.get("ui-grid/edit/cellTextEditor");g=g.replace(a.COL_FIELD,c.row.getQualifiedColField(c.col));var h=e(g)(c);f.append(h);var i=f.find("input")[0];c.$on(b.events.BEGIN_CELL_EDIT,function(){i.focus()}),c.stopEdit=function(){c.$emit(b.events.END_CELL_EDIT)},f.on("keydown",function(d){switch(d.keyCode){case a.keymap.ESC:d.stopPropagation(),c.$emit(b.events.CANCEL_CELL_EDIT);break;case a.keymap.ENTER:d.stopPropagation(),c.stopEdit()}return!0})}}}}}])}(),angular.module("ui.grid").run(["$templateCache",function(a){"use strict";a.put("ui-grid/edit/cellTextEditor",'<input ng-class="\'colt\' + col.index" ng-input="COL_FIELD" ng-model="COL_FIELD" ng-blur="stopEdit()">'),a.put("ui-grid/edit/editableCell",'<div editable_cell_directive=""></div>'),a.put("ui-grid/ui-grid-body",'<div class="ui-grid-body"><div class="ui-grid-scrollbar-box"><div ui-grid-viewport="" class="ui-grid-viewport"><div class="ui-grid-canvas"><div ng-repeat="row in grid.renderedRows track by $index" class="ui-grid-row" ng-style="rowStyle($index)"><div ui-grid-row="row" row-index="$index"></div></div></div></div></div><div ui-grid-scrollbar="" type="vertical" scrolling-class="ui-grid-scrolling"></div><div ui-grid-scrollbar="" type="horizontal" scrolling-class="ui-grid-scrolling"></div></div>'),a.put("ui-grid/ui-grid-header",'<div class="ui-grid-top-panel"><div class="ui-grid-header ui-grid-header-viewport"><div class="ui-grid-header-canvas"><div ng-repeat="col in grid.columns" class="ui-grid-header-cell col{{ $index }}" ng-style="columnStyle($index)"><div class="ui-grid-vertical-bar">&nbsp;</div><div class="ui-grid-cell-contents">{{ col.displayName }}</div></div></div></div><div ui-grid-menu=""></div></div>'),a.put("ui-grid/ui-grid-row",'<div><div ng-repeat="col in grid.renderedColumns" class="ui-grid-cell col{{ col.index }}"><!-- ng-style="{ \'cursor\': row.cursor }" ng-class="col.colIndex()" class="{{col.cellClass}}" --><div class="ui-grid-vertical-bar">&nbsp;</div><!-- ng-style="{height: rowHeight}" ng-class="{ ngVerticalBarVisible: !$last }" --><div ui-grid-cell=""></div></div>'),a.put("ui-grid/ui-grid-scrollbar",'<div class="ui-grid-scrollbar" ng-show="showScrollbar()"></div>'),a.put("ui-grid/ui-grid",'<div class="ui-grid grid{{ grid.id }}"><!-- TODO (c0bra): add "scoped" attr here, eventually? --><style ui-grid-style="">.grid{{ grid.id }} {\n      /* Styles for the grid */\n    }\n\n    .grid{{ grid.id }} .ui-grid-header {\n      width: {{ grid.getViewportWidth() }}px;\n    }\n\n    .grid{{ grid.id }} .ui-grid-header-canvas {\n      width: {{ grid.getCanvasWidth() }}px;\n    }\n\n    .grid{{ grid.id }} .ui-grid-viewport {\n      height: {{ grid.getViewportHeight() }}px;\n      width: {{ grid.getViewportWidth() }}px;\n    }\n\n    .grid{{ grid.id }} .ui-grid-canvas {\n      height: {{ grid.getCanvasHeight() }}px;\n      width: {{ grid.getCanvasWidth() }}px;\n    }\n\n    .grid{{ grid.id }} .ui-grid-row, .grid{{ grid.id }} .ui-grid-cell, .grid{{ grid.id }} .ui-grid-cell .ui-grid-vertical-bar {\n      height: {{ grid.options.rowHeight }}px;\n    }\n\n    .grid{{ grid.id }} .ui-grid-row:last-child .ui-grid-cell {\n      border-bottom-width: {{ ((grid.getTotalRowHeight() < grid.getViewportHeight()) && \'1\') || \'0\' }}px;\n    }\n\n    {{ rowStyles }}\n\n    {{ columnStyles }}\n\n    {{ grid.verticalScrollbarStyles }}\n    {{ grid.horizontalScrollbarStyles }}</style><div ui-grid-header=""></div><div ui-grid-body=""></div><div ui-grid-footer=""></div></div>'),a.put("ui-grid/uiGridCell",'<div class="ui-grid-cell-contents">{{COL_FIELD CUSTOM_FILTERS}}</div>'),a.put("ui-grid/uiGridHeaderCell",'<div class="ngHeaderSortColumn {{col.headerClass}}" ng-style="{\'cursor\': col.cursor}" ng-class="{ \'ngSorted\': !noSortVisible }"><div ng-click="col.sort($event)" ng-class="\'colt\' + col.index" class="ngHeaderText">{{col.displayName}}</div><div class="ngSortButtonDown" ng-show="col.showSortButtonDown()"></div><div class="ngSortButtonUp" ng-show="col.showSortButtonUp()"></div><div class="ngSortPriority">{{col.sortPriority}}</div><div ng-class="{ ngPinnedIcon: col.pinned, ngUnPinnedIcon: !col.pinned }" ng-click="togglePin(col)" ng-show="col.pinnable"></div></div><div ng-show="col.resizable" class="ngHeaderGrip" ng-click="col.gripClick($event)" ng-mousedown="col.gripOnMouseDown($event)"></div>')}]);